language: python
python:
  - 3.5
dist: trusty

addons:
  apt:
    packages:
      - build-essential
      - gcc
      - g++
      - gfortran
      - valgrind
      - bison
      - flex
      - cmake
      - libtool
      - autoconf
      - perl
      - m4
      - git
      - liblapack-dev
      - liblapack3gf
      - libblas-dev
      - libblas3gf
      - wget

cache:
  directories:
    - $HOME/conda
    - $HOME/petsc_and_slepc

before_install:
  - bash deps/travis-install-conda.sh >/dev/null
  - export PATH="$HOME/conda/bin:$PATH"
  - source activate test-environment
  - export PATH="$HOME/local/bin:$PATH"
  - export LD_LIBRARY_PATH="$HOME/local/lib:$LD_LIBRARY_PATH"
  - bash deps/travis-install-openmpi.sh >/dev/null
  - bash deps/travis-install-slepc4py.sh >/dev/null

install:
  - pip install .

script:
  - export OMP_NUM_THREADS=2
  - py.test

after_success:
  - coveralls
  - codecov
  - codeclimate-test-reporter
